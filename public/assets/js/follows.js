var token=$("meta[name=csrf_token]").attr("content");$(document).ready(function(){var t=io(socket_url,{path:"/node/socket.io",transports:["polling","websocket"]}),e=$("#main__user_id").data("id"),a=$(".loader"),s=$(".follow__followers"),l=$(".follow__following"),o=$(".contents"),i=$(".not_found");(location.search||n("?tab=followers"),"followers"===d()||"following"===d())&&("followers"===d()?c("get_followers"):u("get_following"));function n(t){var e=window.location.protocol+"//"+window.location.host+window.location.pathname+t;return window.history.pushState({path:e},"",e)}function d(){var t={};return $.each(document.location.search.substr(1).split("&"),function(e,a){var s=a.split("=");t[s[0].toString()]=s[1].toString()}),t.tab}function c(t){return $.ajax({url:ajax_url_follow,beforeSend:function(){$('<div class="w-100 d-flex justify-content-center align-items-center"></div>').html('<div class="LoaderBalls mt-5"><div class="LoaderBalls__item"></div><div class="LoaderBalls__item"></div><div class="LoaderBalls__item"></div></div>').appendTo(a),o.empty()},data:{action:t,id:logged_id,_token:token},dataType:"JSON",type:"POST",context:this,success:function(t){if("success"===t.status){$.isEmptyObject(t.datas)&&$('<div class="text-center text-danger w-100"></div>').html("You have no followers at the moment").appendTo(o),$.map(t.datas,function(t){t.avatar?$('<div class="col-lg-3 col-sm-4 col-6 mt-4"></div>').html('<div class="follow__content" data-id="'+t.id+'">                                <a href="/u/'+t.username+'" >                                    <div class="d-flex justify-content-center mb-2" style="height: 100px" >                                        <img src="/'+t.avatar+'" alt="'+t.username+'" class="img-fluid rounded-circle" width="100">                                    </div>                                </a>                                <div class="d-flex justify-content-center align-items-center flex-column">                                    <a href="/u/'+t.username+'" ><p class="follo__user_name">'+t.username+'</p></a>                                    <button type="button" class="follow__btn" data-id="'+t.id+'">                                            <div class="btn_text">'+t.follow+'</div>                                            <div class="loading"></div>                                        </button>                                </div>                            </div>').appendTo(o):$('<div class="col-lg-3 col-sm-4 col-6 mt-4"></div>').html('<div class="follow__content" data-id="'+t.id+'">                                <a href="/u/'+t.username+'" >                                    <div class="d-flex justify-content-center mb-2" style="height: 100px" >                                        <img src="assets/images/1.jpg" alt="'+t.username+'" class="img-fluid rounded-circle" width="100">                                    </div>                                </a>                                <div class="d-flex justify-content-center align-items-center flex-column">                                    <a href="/u/'+t.username+'" ><p class="follo__user_name">'+t.username+'</p></a>                                    <button type="button" class="follow__btn" data-id="'+t.id+'">                                            <div class="btn_text">'+t.follow+'</div>                                            <div class="loading"></div>                                        </button>                                </div>                            </div>').appendTo(o)});$(".btn_text"),$(".loading");$(".follow__btn").on("click",function(){var t=$(this).data("id"),e=$(this);$.ajax({url:ajax_url_follow,data:{action:"follow_following",id:t,_token:token},dataType:"JSON",type:"POST",context:this,success:function(t){"success"===t.status&&e.html(t.data)}})});var e=[];$(".follow__content").each(function(){e.push($(this).data("id"))});var s=$("#load__more_main");e.length>=10?$('<button class="custom__load_more_btn  mb-4" id="load__more"></button>').html("Load more").appendTo(s):s.empty(),$("#load__more").on("click",function(){var t=[];$(".follow__content").each(function(){t.push($(this).data("id"))});$.ajax({url:ajax_url_follow,beforeSend:function(){$('<div class="w-100 d-flex justify-content-center align-items-center"></div>').html('<div class="LoaderBalls mt-5"><div class="LoaderBalls__item"></div><div class="LoaderBalls__item"></div><div class="LoaderBalls__item"></div></div>').appendTo(a)},data:{action:"get_followers",id:logged_id,data_id:t,item:10,_token:token},dataType:"JSON",type:"POST",context:this,success:function(t){i.empty(),"success"===t.status&&($.isEmptyObject(t.datas)&&$('<div class="text-center text-danger"></div>').html("No data found!").appendTo(i),$.map(t.datas,function(t){t.avatar?$('<div class="col-lg-3 col-sm-4 col-6 mt-4"></div>').html('<div class="follow__content" data-id="'+t.id+'">                                                <a href="/u/'+t.username+'" >                                                    <div class="d-flex justify-content-center mb-2" style="height: 100px" >                                                        <img src="/'+t.avatar+'" alt="'+t.username+'" class="img-fluid rounded-circle" width="100">                                                    </div>                                                </a>                                                <div class="d-flex justify-content-center align-items-center flex-column">                                                    <a href="/u/'+t.username+'" ><p class="follo__user_name">'+t.username+'</p></a>                                                    <button type="button" class="follow__btn" data-id="'+t.id+'">                                                            <div class="btn_text">'+t.follow+'</div>                                                            <div class="loading"></div>                                                        </button>                                                </div>                                            </div>').appendTo(o):$('<div class="col-lg-3 col-sm-4 col-6 mt-4"></div>').html('<div class="follow__content" data-id="'+t.id+'">                                                <a href="/u/'+t.username+'" >                                                    <div class="d-flex justify-content-center mb-2" style="height: 100px" >                                                        <img src="assets/images/1.jpg" alt="'+t.username+'" class="img-fluid rounded-circle" width="100">                                                    </div>                                                </a>                                                <div class="d-flex justify-content-center align-items-center flex-column">                                                    <a href="/u/'+t.username+'" ><p class="follo__user_name">'+t.username+'</p></a>                                                    <button type="button" class="follow__btn" data-id="'+t.id+'">                                                            <div class="btn_text">'+t.follow+'</div>                                                            <div class="loading"></div>                                                        </button>                                                </div>                                            </div>').appendTo(o)}))},complete:function(){a.empty()}})})}},complete:function(){a.empty()}})}function u(t){return $.ajax({url:ajax_url_follow,beforeSend:function(){$('<div class="w-100 d-flex justify-content-center align-items-center"></div>').html('<div class="LoaderBalls mt-5"><div class="LoaderBalls__item"></div><div class="LoaderBalls__item"></div><div class="LoaderBalls__item"></div></div>').appendTo(a),o.empty()},data:{action:t,id:logged_id,_token:token},dataType:"JSON",type:"POST",context:this,success:function(t){if("success"===t.status){$.isEmptyObject(t.datas)&&$('<div class="text-center text-danger w-100"></div>').html("You follow no one at the moment!").appendTo(o),$.map(t.datas,function(t){t.avatar?$('<div class="col-lg-3 col-sm-4 col-6 mt-4"></div>').html('<div class="follow__content" data-id="'+t.id+'">                                <a href="/u/'+t.username+'" >                                    <div class="d-flex justify-content-center mb-2" style="height: 100px" >                                        <img src="'+t.avatar+'" alt="'+t.username+'" class="img-fluid rounded-circle" width="100">                                    </div>                                </a>                                <div class="d-flex justify-content-center align-items-center flex-column">                                    <a href="/u/'+t.username+'" ><p class="follo__user_name">'+t.username+'</p></a>                                    <button type="button" class="following__btn" data-id="'+t.id+'">                                            <div class="btn_text">'+t.follow+'</div>                                            <div class="loading"></div>                                        </button>                                </div>                            </div>').appendTo(o):$('<div class="col-lg-3 col-sm-4 col-6 mt-4"></div>').html('<div class="follow__content" data-id="'+t.id+'">                                <a href="/u/'+t.username+'" >                                    <div class="d-flex justify-content-center mb-2" style="height: 100px" >                                        <img src="assets/images/1.jpg" alt="'+t.username+'" class="img-fluid rounded-circle" width="100">                                    </div>                                </a>                                <div class="d-flex justify-content-center align-items-center flex-column">                                    <a href="/u/'+t.username+'" ><p class="follo__user_name">'+t.username+'</p></a>                                    <button type="button" class="following__btn" data-id="'+t.id+'">                                            <div class="btn_text">'+t.follow+'</div>                                            <div class="loading"></div>                                        </button>                                </div>                            </div>').appendTo(o)});$(".btn_text"),$(".loading");$(".contents").delegate(".following__btn","click",function(){var t=$(this).data("id"),e=$(this);$.ajax({url:ajax_url_follow,data:{action:"unfollowing",id:t,_token:token},dataType:"JSON",type:"POST",context:this,success:function(t){"success"===t.status&&(e.html(t.data),e.closest(".col-lg-3").remove())}})});var e=[];$(".follow__content").each(function(){e.push($(this).data("id"))});var s=$("#load__more_main");e.length>=10?$('<button class="custom__load_more_btn  mb-4" id="load__more"></button>').html("Load more").appendTo(s):s.empty(),$("#load__more").on("click",function(){var t=[];$(".follow__content").each(function(){t.push($(this).data("id"))});$.ajax({url:ajax_url_follow,beforeSend:function(){$('<div class="w-100 d-flex justify-content-center align-items-center"></div>').html('<div class="LoaderBalls mt-5"><div class="LoaderBalls__item"></div><div class="LoaderBalls__item"></div><div class="LoaderBalls__item"></div></div>').appendTo(a)},data:{action:"get_following",id:logged_id,data_id:t,item:10,_token:token},dataType:"JSON",type:"POST",context:this,success:function(t){i.empty(),"success"===t.status&&($.isEmptyObject(t.datas)&&$('<div class="text-center text-danger"></div>').html("Thats it!").appendTo(i),$.map(t.datas,function(t){t.avatar?$('<div class="col-lg-3 col-sm-4 col-6 mt-4"></div>').html('<div class="follow__content" data-id="'+t.id+'">                                                <a href="/u/'+t.username+'" >                                                    <div class="d-flex justify-content-center mb-2" style="height: 100px" >                                                        <img src="/'+t.avatar+'" alt="'+t.username+'" class="img-fluid rounded-circle" width="100">                                                    </div>                                                </a>                                                <div class="d-flex justify-content-center align-items-center flex-column">                                                    <a href="/u/'+t.username+'" ><p class="follo__user_name">'+t.username+'</p></a>                                                    <button type="button" class="following__btn" data-id="'+t.id+'">                                                            <div class="btn_text">'+t.follow+'</div>                                                            <div class="loading"></div>                                                        </button>                                                </div>                                            </div>').appendTo(o):$('<div class="col-lg-3 col-sm-4 col-6 mt-4"></div>').html('<div class="follow__content" data-id="'+t.id+'">                                                <a href="/u/'+t.username+'" >                                                    <div class="d-flex justify-content-center mb-2" style="height: 100px" >                                                        <img src="assets/images/1.jpg" alt="'+t.username+'" class="img-fluid rounded-circle" width="100">                                                    </div>                                                </a>                                                <div class="d-flex justify-content-center align-items-center flex-column">                                                    <a href="/u/'+t.username+'" ><p class="follo__user_name">'+t.username+'</p></a>                                                    <button type="button" class="following__btn" data-id="'+t.id+'">                                                            <div class="btn_text">'+t.follow+'</div>                                                            <div class="loading"></div>                                                        </button>                                                </div>                                            </div>').appendTo(o)}))},complete:function(){a.empty()}})})}},complete:function(){a.empty()}})}function r(t,e,a){var s="; max-age="+a;document.cookie=encodeURI(t)+"="+encodeURI(e)+s}"followers"===d()?(s.addClass("follow__tab_active"),l.removeClass("follow__tab_active")):(l.addClass("follow__tab_active"),s.removeClass("follow__tab_active")),s.off("click").on("click",function(){$(this).addClass("follow__tab_active"),l.removeClass("follow__tab_active"),n("?tab=followers"),c("get_followers"),i.empty()}),l.off("click").on("click",function(){$(this).addClass("follow__tab_active"),s.removeClass("follow__tab_active"),n("?tab=following"),u("get_following"),i.empty()}),$("#status__input").on("keypress",function(a){if(13===a.which){var s=$(a.currentTarget).val();$.ajax({url:ajax_url_follow,data:{action:"updateStatus",id:e,status:s,_token:token},dataType:"JSON",type:"POST",context:this,success:function(e){"success"===e.status&&(t.emit("notifications",e.user.username),$("#status__input").val(""),r("update-status","status",5),window.location.href="/u/"+e.user.username)}})}}),$(".status__btn").on("click",function(a){var s=$(a.currentTarget).val();$.ajax({url:ajax_url_follow,data:{action:"updateStatus",id:e,status:s,_token:token},dataType:"JSON",type:"POST",context:this,success:function(e){"success"===e.status&&(t.emit("notifications",e.user.username),$("#status__input").val(""),r("update-status","status",5),window.location.href="/u/"+e.user.username)}})})});
